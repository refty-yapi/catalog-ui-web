(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7047:function(e,t,s){Promise.resolve().then(s.bind(s,9200))},9200:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return b}});var r=s(3827),n=s(7907),l=s(4090),a=s(9413),o=s(3203),c=s(4692);function i(){let e=(0,n.useRouter)();return(0,r.jsx)(c.K,{onClick:()=>{e.push("/auth")},children:"Login"})}function d(e){let{url:t}=e,[s,n]=(0,l.useState)([]),[c,d]=(0,l.useState)(0),[u,m]=(0,l.useState)(!1),[x,p]=(0,l.useState)(null);async function h(){m(!0),p(null);try{let e=await (0,a.Z)("".concat(t).concat(t.includes("?")?"&":"?","limit=").concat(20,"&offset=").concat(c));if(!e.ok){let t=await e.json();throw Error(t.error||"Unknown error occurred")}let s=await e.json();n(e=>{let t=s.filter(t=>!e.some(e=>e.adId===t.adId)),r=[...e,...t];return sessionStorage.setItem("properties",JSON.stringify(r)),sessionStorage.setItem("offset","".concat(c)),r})}catch(e){p("401")}finally{m(!1)}}return(0,l.useEffect)(()=>{let e=sessionStorage.getItem("properties"),t=sessionStorage.getItem("offset");e?(n(JSON.parse(e)),d(t?parseInt(t,10):0)):h()},[]),(0,l.useEffect)(()=>{0!==c&&h()},[c]),(0,l.useEffect)(()=>{let e=()=>{window.innerHeight+document.documentElement.scrollTop>=.9*document.documentElement.scrollHeight&&!u&&d(e=>e+20)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[u]),(0,l.useEffect)(()=>{n([]),d(0),sessionStorage.removeItem("properties"),sessionStorage.removeItem("offset"),h()},[t]),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-4",children:[x&&(0,r.jsx)("div",{className:"error-message col-span-full",children:"401"===x?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"mb-2 text-red-500",children:"Login please"}),(0,r.jsx)(i,{})]}):(0,r.jsx)("p",{className:"text-red-500",children:x})}),s.map(e=>(0,r.jsx)(o.Z,{property:e},e.adId)),u&&(0,r.jsx)("div",{className:"col-span-full mb-16 text-lg",children:"⌛️ Loading more properties..."})]})}var u=s(407),m=s(7929);let x=[{name:"Telegram",url:"https://t.me/share/url?url="},{name:"WhatsApp",url:"https://api.whatsapp.com/send?text="},{name:"Facebook",url:"https://www.facebook.com/sharer/sharer.php?u="},{name:"Twitter",url:"https://twitter.com/intent/tweet?url="},{name:"LinkedIn",url:"https://www.linkedin.com/shareArticle?url="}];function p(){let[e,t]=(0,l.useState)(""),[s,n]=(0,l.useState)(!1),a=(0,l.useRef)(null);return(0,l.useEffect)(()=>{t(window.location.href)},[]),(0,l.useEffect)(()=>{function e(e){a.current&&!a.current.contains(e.target)&&n(!1)}return s?document.addEventListener("mousedown",e):document.removeEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[s]),(0,r.jsxs)("div",{className:"relative",ref:a,children:[(0,r.jsx)("button",{onClick:()=>n(e=>!e),className:"flex items-center space-x-1 text-lime-100 hover:text-blue-600 border border-gray-300 px-3 py-2 rounded-md text-sm font-medium transition bg-stone-700",children:(0,r.jsx)("span",{children:"\uD83D\uDD17 Share"})}),s&&(0,r.jsx)("div",{className:"absolute top-full left-0 mt-2 w-40 bg-white border rounded-md shadow-lg",children:x.map(t=>{let{name:s,url:n}=t;return(0,r.jsx)("a",{href:"".concat(n).concat(encodeURIComponent(e)),target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:s},s)})})]})}var h=s(9381);function f(e){let{property:t,userId:s,onClick:n}=e,{saved:a,addSaved:o,removeSaved:c}=(0,h.Z)(s),[i,d]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{d(a.includes(t))},[a,t]),(0,r.jsx)("button",{className:"py-2 px-4 bg-gray-200 rounded-lg hover:bg-gray-300",onClick:()=>{i?c(t):o(t),d(!i),n()},children:(0,r.jsx)("span",{className:"text-md",children:i?"❤️":"\uD83E\uDD0D"})})}function g(e){var t;let{propertyId:s}=e;(0,n.useRouter)();let[o,c]=(0,l.useState)(null),[i,d]=(0,l.useState)(!0),[x,h]=(0,l.useState)(null),[g,j]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{(async function(){if(s){d(!0),h(null);try{let e=await (0,a.Z)("/properties?id=".concat(s));if(!e.ok){let t=await e.json();throw Error(t.error||"Unknown error occurred")}let t=await e.json();c(t)}catch(e){h(e.message)}finally{d(!1)}}})()},[s]),i)?(0,r.jsx)("div",{className:"flex justify-center items-center h-screen",children:"⌛️ Loading property details..."}):x?(0,r.jsxs)("div",{className:"flex justify-center items-center h-screen",children:["Error: ",x]}):o?(0,r.jsxs)("section",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"flex flex-col justify-between mb-4",children:[(0,r.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800"}),(0,r.jsxs)("p",{className:"text-gray-500 text-sm mt-1",children:[(0,m.pn)(o.purpose)," - ",o.category_name," - ",o.building," - ",null!==(t=o.tail_location)&&void 0!==t?t:o.distict]})]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)("span",{className:"bg-blue-100 text-blue-700 px-4 py-2 inline-block rounded text-xl font-semibold",children:["AED ",(0,m.JZ)(o.price)]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,r.jsx)("div",{children:o.photos&&o.photos.length>0&&(0,r.jsx)(u.Z,{photos:o.photos,dynamicSlides:!0})}),(0,r.jsxs)("div",{className:"flex items-center space-x-6 text-gray-600 mb-4",children:[(0,r.jsxs)("span",{children:["\uD83D\uDECF️ ",(0,m.z8)(o.rooms).split(" ")[0]," Beds"]}),(0,r.jsxs)("span",{children:["\uD83D\uDEC1 ",o.baths," Baths"]}),(0,r.jsxs)("span",{children:["\uD83D\uDCCF ",o.area.toFixed(2)," sqm"]})]}),(0,r.jsxs)("div",{className:"flex mt-4 gap-4",children:[(0,r.jsx)(p,{}),(0,r.jsx)(f,{property:o,userId:"123",onClick:()=>{j(!g)}})]})]}),(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,r.jsx)("img",{src:o.photo_broker,alt:"Agent",className:"w-16 h-16 rounded-full object-cover"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-gray-800",children:"Refty Agent"}),(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"Refty Agency"})]})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition text-sm",children:"Contact"}),(0,r.jsx)("button",{className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition text-sm",children:"Call"})]})]})})]})]}):(0,r.jsx)("div",{className:"flex justify-center items-center h-screen",children:"Not found"})}var j=s(6271);function b(){let e=(0,n.useSearchParams)(),t=e.get("property"),s=e.get("location"),a=(0,n.useRouter)(),{isTelegram:o,setBackButtonLogic:c}=(0,j.useTelegram)(),[i,u]=(0,l.useState)(""),m=s?"?location=".concat(encodeURIComponent(s)):i?"?location=".concat(encodeURIComponent(i)):"";return(0,l.useEffect)(()=>{!t&&s&&u(s)},[t,s]),(0,l.useEffect)(()=>{o&&t&&c(()=>{a.replace("/"+m)})},[o,t,a,c,m]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"transition-transform duration-300 ".concat(t?"absolute top-0 left-0 w-full -translate-x-full":"translate-x-0"),children:(0,r.jsx)(d,{url:"/properties"+m})}),t&&(0,r.jsx)(g,{propertyId:t})]})}}},function(e){e.O(0,[946,645,971,69,744],function(){return e(e.s=7047)}),_N_E=e.O()}]);