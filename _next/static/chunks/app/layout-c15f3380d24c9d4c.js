(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{985:function(e,l,t){Promise.resolve().then(t.bind(t,8868)),Promise.resolve().then(t.t.bind(t,3385,23))},8868:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return I}});var a=t(3827),s=t(4090),r=t(7907),n=t(146),i=t(9413),c=t(7929),o=t(8792);let u=()=>{let[e,l]=(0,s.useState)(""),[t,r]=(0,s.useState)(null),[n,u]=(0,s.useState)([]);async function d(){let e=await (0,i.Z)("/locations"),l=await e.json();l&&r(l)}(0,s.useEffect)(()=>{d()},[]);let m=(e,l)=>{if(!l)return[];for(let t of e.toLowerCase()){if(!l.children[t])return[];l=l.children[t]}let t=(e,l,a)=>{for(let s in e.isEndOfWord&&a.push(l),e.children)t(e.children[s],l+s,a)},a=[];return t(l,e,a),a};return(0,a.jsxs)("header",{className:"bg-white shadow-md flex justify-between items-center p-4 sticky top-0 z-50",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("img",{src:"/logo.webp",alt:"Refty",className:"h-8 w-8 mr-2"}),(0,a.jsx)(o.default,{href:"/",children:(0,a.jsx)("span",{className:"text-xl font-bold text-gray-800",children:"Refty"})})]}),(0,a.jsxs)("div",{className:"relative w-1/2",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>{let a=e.target.value;l(a),a.length>1?u(m(a,t)):u([])},placeholder:"\uD83D\uDD0D Start your search",className:"border p-2 rounded w-full pl-5 h-10"}),n.length>0&&(0,a.jsx)("ul",{className:"absolute top-full left-0 w-full bg-white border mt-1 rounded shadow-md z-50",children:n.slice(0,5).map((e,t)=>(0,a.jsx)("li",{className:"p-2 cursor-pointer hover:bg-gray-100",onClick:()=>{l((0,c.Ls)(e)),sessionStorage.setItem("properties","[]"),u([])},children:(0,c.Ls)(e)},t))})]})]})};var d=t(8745),m=t(5460),h=t(8053),x=t(4692);function p(){let[e,l]=(0,s.useState)(null),t=(0,r.useRouter)();(0,s.useEffect)(()=>{let e=localStorage.getItem("user");e&&l(JSON.parse(e))},[]);let n=async()=>{localStorage.removeItem("user"),document.cookie="auth_token=; Max-Age=0; path=/",sessionStorage.clear(),t.push("/auth")};return e?(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-bold mt-16 mb-4",children:"Profile"}),(0,a.jsxs)("p",{children:["Email: ",e.email]}),e.name&&(0,a.jsxs)("p",{children:["Name: ",e.name]}),(0,a.jsx)("div",{className:"mt-8",children:(0,a.jsx)(x.K,{className:"border-2 border-indigo-200",onClick:n,children:"Logout"})})]}):null}let f=e=>{let{value:l,onChange:t,options:s}=e;return(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)("select",{value:l,onChange:e=>t(e.target.value),className:"block w-full p-2 border rounded"+h.M.mainBg,children:s.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})})},v=e=>{let{value:l,onChange:t}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Purpose"}),(0,a.jsx)(f,{value:l,onChange:e=>{t(e)},options:[{value:"for-rent",label:"For Rent"},{value:"for-sale",label:"For Sale"},{value:"",label:"All"}]})]})},j=e=>{let{onPriceChange:l}=e,[t,r]=(0,s.useState)(""),[n,i]=(0,s.useState)("");return(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Price Range"}),(0,a.jsxs)("div",{className:"flex space-x-4 mt-1",children:[(0,a.jsx)("input",{type:"number",value:t,onChange:e=>{r(e.target.value),l(e.target.value,n)},placeholder:"Min",className:"p-2 border rounded w-1/2"}),(0,a.jsx)("input",{type:"number",value:n,onChange:e=>{i(e.target.value),l(t,e.target.value)},placeholder:"Max",className:"p-2 border rounded w-1/2"})]})]})},b=e=>{let{value:l,onChange:t}=e;return(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Rooms"}),(0,a.jsx)(f,{value:l,onChange:t,options:[{value:"studio",label:"Studio"},{value:"1",label:"1 BR"},{value:"2",label:"2 BR"},{value:"3",label:"3 BR"},{value:"4",label:"4 BR"},{value:"5",label:"5 BR"},{value:"6",label:"6 BR"},{value:"7",label:"7 BR"},{value:"7+",label:"7+"}]})]})},g=e=>{let{value:l,onChange:t}=e;return(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Furnishing"}),(0,a.jsx)(f,{value:l,onChange:t,options:[{value:"furnished",label:"Furnished"},{value:"unfurnished",label:"Unfurnished"},{value:"partly",label:"Partly"}]})]})},y=e=>{let{onAreaChange:l}=e,[t,r]=(0,s.useState)(""),[n,i]=(0,s.useState)("");return(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Area"}),(0,a.jsxs)("div",{className:"flex space-x-4 mt-1",children:[(0,a.jsx)("input",{type:"number",value:t,onChange:e=>{r(e.target.value),l(e.target.value,n)},placeholder:"Min",className:"p-2 border rounded w-1/2"}),(0,a.jsx)("input",{type:"number",value:n,onChange:e=>{i(e.target.value),l(t,e.target.value)},placeholder:"Max",className:"p-2 border rounded w-1/2"})]})]})},N=e=>{let{value:l,onChange:t}=e;return(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Completion Status"}),(0,a.jsx)(f,{value:l,onChange:t,options:[{value:"completed",label:"Completed"},{value:"under-construction",label:"Under-Construction"},{value:"",label:"All"}]})]})},w=e=>{let{onApplyFilters:l}=e,[t,r]=(0,s.useState)({purpose:"for-rent",minPrice:"",maxPrice:"",city:"Dubai",district:["All Districts"],rooms:"studio",furnishing:"furnished",minArea:"",maxArea:"",completionStatus:"completed"});return(0,s.useEffect)(()=>{r({...t,district:["All Districts"]})},[t.city]),(0,a.jsxs)("div",{className:"p-6 space-y-4",children:[(0,a.jsx)(v,{value:t.purpose,onChange:e=>r({...t,purpose:e})}),(0,a.jsx)(j,{onPriceChange:(e,l)=>r({...t,minPrice:e,maxPrice:l})}),(0,a.jsx)(b,{value:t.rooms,onChange:e=>r({...t,rooms:e})}),(0,a.jsx)(g,{value:t.furnishing,onChange:e=>r({...t,furnishing:e})}),(0,a.jsx)(y,{onAreaChange:(e,l)=>r({...t,minArea:e,maxArea:l})}),(0,a.jsx)(N,{value:t.completionStatus,onChange:e=>r({...t,completionStatus:e})}),(0,a.jsx)(x.K,{onClick:()=>{l(t)},children:"Apply Filters"})]})};var C=t(9381),S=t(3203);function k(e){let{userId:l,onClose:t}=e,{saved:r}=(0,C.Z)(l),[n,i]=(0,s.useState)("Properties");return(0,a.jsx)("div",{className:"",children:(0,a.jsxs)("div",{className:"rounded-md w-100",children:[(0,a.jsxs)("h2",{className:"text-lg font-bold mb-4",children:["Saved ",n]}),(0,a.jsx)("ul",{children:0===r.length?(0,a.jsx)("p",{children:"You haven't selected any favorite properties yet"}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-4",children:r.map(e=>(0,a.jsx)(S.Z,{property:e,onClick:t},e.adId))})}),(0,a.jsx)("div",{className:"mt-8",children:(0,a.jsx)(x.K,{onClick:t,children:"Close"})})]})})}let P=e=>{let{onClose:l,type:t}=e;return(0,s.useEffect)(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[]),(0,a.jsx)(d.M,{children:(0,a.jsx)(m.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-10 flex justify-center items-center",onClick:l,children:(0,a.jsx)(m.E.div,{initial:{y:50,opacity:0},animate:{y:0,opacity:1},exit:{y:50,opacity:0},className:"".concat(h.M.mainBg," w-full h-full max-h-screen overflow-y-auto p-5 relative"),onClick:e=>e.stopPropagation(),children:(0,a.jsx)("div",{className:"mt-16 mb-16",children:(e=>{switch(e){case"collections":return(0,a.jsx)("div",{children:"Подборки"});case"saved":return(0,a.jsx)(k,{userId:"123",onClose:l});case"search":l();case"filter":return(0,a.jsx)(w,{onApplyFilters:e=>{console.log(e),l()}});case"profile":return(0,a.jsx)(p,{});default:return null}})(t)})})})})};var A=t(5403),R=t(3565),E=t(2064),B=t(8350),M=t(3290);let _=[{id:1,type:"collections",title:"Collections",icon:A.B},{id:2,type:"saved",title:"Saved",icon:R.U},{id:3,type:"search",title:"Search",icon:E.Y},{id:4,type:"filter",title:"Filter",icon:B.E},{id:5,type:"profile",title:"Profile",icon:M.n}],D=e=>{let{onOpen:l,MenuItem:t,className:s,isActive:r}=e,n=t.icon;return(0,a.jsxs)("button",{onClick:l,className:"".concat(s," ").concat(r?"text-slate-700 bg-lime-100":"text-slate-950"),children:[(0,a.jsx)(n,{size:24,weight:r?"fill":"regular",className:r?"text-lime-600":"text-gray-600"}),(0,a.jsx)("p",{className:"text-center text-xs sm:text-sm",children:t.title})]})},F=()=>{let[e,l]=(0,s.useState)(!1),[t,r]=(0,s.useState)(null),n=e=>{t===e?(l(!1),r(null)):(r(e),l(!0))},i=()=>{l(!1),r(null)};return(0,a.jsxs)("footer",{children:[(0,a.jsx)("nav",{className:"fixed bottom-0 px-5 w-full shadow-lg flex items-center justify-between z-40 bg-white",children:_.map(e=>{let l=t===e.type;return(0,a.jsx)(D,{onOpen:()=>n(e.type),MenuItem:e,isActive:l,className:"flex flex-col items-center py-2 w-full"},e.id)})}),e&&(0,a.jsx)(P,{type:t,onClose:()=>i()})]})};function I(e){let{children:l}=e,t=(0,r.usePathname)(),c=(0,r.useSearchParams)(),o=(0,r.useRouter)(),d="/auth"===t,[m,h]=(0,s.useState)(!0);return((0,s.useEffect)(()=>{async function e(){if(!n.Z.get("auth_token")){o.replace("/auth");return}try{let e=await (0,i.Z)("/verify");(await e.json()).valid||(n.Z.remove("auth_token"),o.replace("/auth"))}catch(e){console.error("Auth check failed:",e),o.replace("/auth")}finally{h(!1)}}d?h(!1):e()},[t,c.toString()]),m)?null:(0,a.jsxs)("div",{className:"flex flex-col min-h-screen",children:[!d&&(0,a.jsx)(u,{}),(0,a.jsx)("main",{className:"flex-grow",children:l}),!d&&(0,a.jsx)(F,{})]})}},3385:function(){}},function(e){e.O(0,[946,353,242,971,69,744],function(){return e(e.s=985)}),_N_E=e.O()}]);